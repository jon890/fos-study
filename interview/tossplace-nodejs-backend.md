# Tossplace Node.js Developer

### 합류하게 될 팀에 대해 알려드려요

- 토스플레이스 Node.js Developer는 SDK Platform 팀에 소속돼요.
- SDK Platform 팀은 토스플레이스 서비스와 다양한 프랜차이즈를 유연하고 확장성 있는 구조로 연동하는 플러그인 SDK를 개발하고 고도화해요.
- 토스플레이스 팀원들이 더 효율적으로 일할 수 있도록 필요한 업무 플랫폼을 개발하고, 이를 통해 모든 팀원에게 긍정적인 영향을 미치고 인사이트를 제공해요.
- 최신 기술 스택을 활용해 빠르고 확장성 높은 제품을 구현하고 있으며, 성장하는 서비스의 핵심적인 역할을 하고 있어요.

## 합류하면 함께할 업무예요

- 오프라인 결제 및 매장 경험을 혁신하기 위해, 토스플레이스가 만드는 토스 포스(POS)에서 실행되는 확장 프로그램 플랫폼(플러그인 SDK)을 설계하고 개발해요.
- 토스 포스에 배달 연동 기능을 개발해 점주의 운영 효율을 극대화하고, 토스 포스 하나로 매장 운영이 가능하도록 도와요.
- 토스플레이스 팀 전체의 생산성을 높이기 위한 업무 자동화 플랫폼을 구축해요.

## 이런 분과 함께하고 싶어요

- 사용자들의 모바일 행동이 훨씬 쉬워지도록 도운 경험이 있으신 분을 찾고 있어요.
- 외부 상황에 따라 서비스가 중단되지 않도록 데이터를 수집하고 모니터링해 보신 경험이 있으신 분을 찾고 있어요.
- 유연하면서도 가독성이 좋은 코드, 유지보수가 가능한 코드를 작성하실 수 있는 분을 찾고 있어요.
- 반복적인 업무 프로세스의 패러다임을 바꾸고 새로운 방식으로 전환한 경험이 있으면 좋아요.
- 더 좋은 개발자 경험(Developer Experience)을 만드는 것에 관심이 많은 분이면 좋아요.

## 공식자료

- [포스를 확장하는 가장 빠른 방법, 포스 플러그인](https://toss.tech/article/toss-pos-plugin)
- [조직의 생산성을 높이는 Process Mining](https://www.youtube.com/watch?v=L4Qk4kLY8zs)
- [토스플레이스 리더십 인터뷰 : '당연함을 재정의하는 경험'에 대한 제안](https://toss.im/career/article/tossplaceleadership)

## 과제관련 질문 준비

### HTTP 클라이언트 선택 관련

#### Http Client (Ky)를 선택한 이유에 대해서 알려주세요

- ky는 fetch를 래핑한 얇은 추상화라, 브라우저/Node간 동작 차이가 적고 Web 표준에 가까운 라이브러리 입니다.
- Node 18버전 이상부터는 fetch를 기본 제공하고, POS, 브라우저, 서버 코드 공유에 유리할 것으로 판단했습니다.
- ky는 작지만 딱맞는 기능을 포함하고 있었는데요, 재시도, 타임아웃, 공통 헤더, JSON 처리, hook등의 기능이 포함되어 있어서 요구사항에 적절하다고 판단했습니다.

#### 그렇다면 ky에서 타임아웃 처리는 어떻게 동작하는지 알고 계시나요?

- fetch 자체엔 timeout 옵션은 없습니다.
- AbortController의 signal을 `fetch(url, { signal })`로 넘기면, 우리가 특정 시간 뒤, `controller.abort()`를 호출해서 **진행 중인 요청을 강제로 취소**할 수 있습니다.
- timeout 동작은 fetch 직전에, `setTimeout`을 설정해두고, 요청 시간이 초과되면 Proimse를 reject되게 하여 동작하도록 구현되어있습니다.

#### AbortController의 abort(취소)가 왜 필요할까요?

- 클라이언트(브라우저/Node)가 **더 이상 응답을 기다리지 않고**
- 가능한 경우 **네트워크 스트림도 끊어서** 리소스(소켓/메모리)를 회수합니다.

#### 왜 Node에도 fetch 구현이 생겼는지 알고 계시나요?

- Node에 fetch가 들어간 건 단순한 API 추가가 아니라, 브라우저, 서버, 엣지, 툴링 생태계를 하나의 표준 인터페이스로 묶으려는 런타임 차원의 전략적 선택이라고 생각합니다.

### 대용량 CSV 및 스트림 처리 관련

#### Csv를 readFileSync로 처리하셨는데 csv 파일이 더 커지면 어떻게 될까요?

- `fs.readFileSync`는 파일 전체를 한 번에 읽어서 Node 프로세스 힙 메모리에 Buffer (또는 String) 으로 올립니다.
- 그래서 파일이 크면 메모리 사용량과 GC 부담이 증가할 수 있습니다.
- 처리 완료 전까지 메모리 해제가 불가능하므로, 스트림으로 처리하는 편이 바람직합니다.

#### Stream 처리는 어떻게 동작하는 방식이고 Node에서 내부적으로 어떻게 동작하는지 알고 계시나요?

- 파일을 작은 chunk 단위로 읽고, 읽자마자 처리하고, 처리 끝나면 버리는 방식으로 동작할 수 있습니다
- 메모리에는 chunkSize 수준으로 올라가고, GC 부담이 적습니다.
- 또한 CSV는 줄 단위로 처리 가능하기 떄문에 순차 처리에 적잡하고 스트림으로 처리하기 적합합니다.
- Node에서는 `fs.createReadStream()` 으로 파일 스트림을 열 수 있습니다.

#### 스트림에서 에러 처리는 어떻게 해야하나요?

#### Backpressure의 개념과 동작 원리에 대해서 알고 계시나요?

- Backpressure는 소비자가 처리하지 못할 만큼 데이터가 빠르게 들어올 떄, 생산자의 속도를 늦추는 메커니즘 입니다.
- 위 상황에서 CSV 파일은 빠르게 읽고, DB Insert가 느리다면, 메모리에 계속 데이터가 쌓여 OOM이 발생할 수도 있습니다.
- Node 스트림에서는 내부 버퍼를 활용하게 되는데요, 이 때 최대 버퍼 크기가 있고, 이를 설정할 수 있습니다.
- 최대 버퍼 크기는 기본 값으로 64KB이고, 소비자가 버퍼를 빠르게 소비하지 못하고, 최대 버퍼 크기에 도달하게 되면, 파일 읽기를 일시 정지하여, 생산 소비를 제어할 수 있습니다.

#### Node에서 pipe와 pipeline 메소드의 차이점을 알고 계시나요?

- 단순히 동작시키는 코드라면 `pipe()`도 충분하지만, 운영 환경에서 안정성을 보장해야 배치는 `pipeline()`이 의도를 더 잘 드러내고 실패를 안전하게 다룰 수 있다고 생각합니다.

## 이력서 질문 준비

### 반복적인 업무 프로세스 패러다임을 바꾸고 새로운 방식으로 전환한 경험이 있나요?

-

### 더 좋은 개발자 경험을 만들어 본적이 있다면 소개해 주세요

-
