# 4장. 논리적 모델링 (공부 중..)

이제부터는 이 청사진을 실제 관계형 데이터베이스에 가깝게 다듬는 **논리적 모델링 단계**로 들어가보자.

논리적 모델링이란 **관계형 데이터베이스 구조**에 맞게 변환하는 과정이다.
엔티티는 **테이블로**, 속성은 **컬럼**으로 바꾸고, 각 테이블의 **기본 키(Primary Key)** 와 테이블 간의 관계를 표현하는 **외래 키(Foreign Key)** 를 정의한다. 이 단계에는 특정 관계형 데이터베이스 시스템(MySQL, Oracle등)에 종속되지 않는, 순수한 관계형 데이터베이스 모델을 만드는 것이 목표다.

> 릴레이션 용어
>
> 논리적 모델링 단계에서 학술적으로는 **릴레이션, 튜플, 속성**이라는 용어를 사용한다.
> 하지만 실무에서는 거의 쓰지 않고, 대신에 **테이블, 행, 컬럼**이라는 용어를 사용한다.

## 키 (Key)

- 왜 '키'가 중요할까?
  - 만약 상품 테이블에 이름과 가격이 똑같은 상품이 두 개 등록되어있다고 가정해보자, 고객이 주문한 상품이 둘 중 어느 것인지 어떻게 구별할까?
  - 이러한 문제를 해결하기 위해 데이터베이스는 각 데이터 행(Row)을 **유일하게 식별할 수 있는 장치**가 필요하다.
  - 그 것이 바로 '키'다.
- 키는 단순히 데이터를 찾는 용도로만 쓰이지 않는다.
  - 테이블과 테이블을 연결하여 관계를 맺어준다.
  - 데이터가 중복되거나 잘못 입력되는 것을 막아주는 **무결성 제약조건**의 역할도 수행한다.

### 모든 데이터를 구별하는 열쇠, 키(Key)

키(Key)는 테이블에 있는 각각의 행(Row)을 고유하게 식별할 수 있는 하나 이상의 컬럼 집합이다.

- **기본 키 (Primary Key - PK)**
  - 테이블의 모든 행을 유일하게 식별하는 **대표 키**다.
  - 기본 키가 지켜야할 규칙
    - **NULL 값을 가질 수 없다. (NOt NULL)**
    - **반드시 유일해야 한다. (UNIQUE)**
    - **값이 변하지 않아야 한다 (불변성)**
      - 이론적으로는 변경할 수 있다.
      - 하지만 기본 키 값이 변하면 이 키를 참조하는 모든 외래 키(FK)와 데이터 무결성에 큰 문제가 생긴다.
      - **실무에서는 절대로 변경하지 않아야 한다.**
- **후보 키(Candidate Key)**
  - 기본 키가 될 수 있는 후보들이라고 생각하면 된다.
    - 기본 키가 될 수 있도록 **유일성**과 **최소성**을 모두 만족해야 한다.
      - **유일성** : 모든 행을 서로 구분할 수 있어야 한다.
      - **최소성** : 행을 유일하게 식별하는 데 꼭 필요한 최소한의 컬럼만 포함해야 한다.
- **대체 키(Alternate Key)**
  - 후보 키 중 **기본 키로 선택되지 않은 나머지 키**다.
  - 이 역시 데이터를 찾는 데 유용하게 사용할 수 있다.
- **외래 키(Foreign Key - FK)**
  - 가장 중요한 키 중 하나로, **테이블 간의 관계를 연결하는 역할**을 한다.
  - 한 테이블의 컬럼이 다른 테이블의 **기본 키**를 참조하는 것이다.
  - 덕분에 우리는 주문 정보를 보고 어떤 회원이 주문했는지 알 수 있게 된다.

#### 최소성이란?

유일성을 만족하더라도, 불필요한 컬럼을 포함하여 최소성을 만족하지 못하는 키는 후보 키가 될 수 없다. </br>
여러 컬럼을 묶어서 하나의 키를 구성할 수 있는데, 이를 **복합키**라고 한다.

## 자연 키 vs 대리 키 - 자연 키

기본 키를 선택하는 과정에서 우리는 두 가지 후보, </br>
**자연 키**와 **대리 키**를 만나게 된다.

</br>

### 자연 키(Natural Key)란?

우리의 비즈니스 로직 안에서 **자연스럽게 발생하는, 의미를 가진 데이터**를 기본 키로 사용하는 것을 말한다.

- 대한 민국 국민: `주민등록번호`
- 도서: `ISBN`

장점:

- **직관성**: 값만 봐도 어떤 데이터를 가르키는지 쉽게 이해할 수 있다.
- **중복 방지**: 데이터베이스 차원에서 값의 중복을 원천적으로 막을 수 있다.

### 자연 키의 치명적 약점: '변경'이라는 시한폭탄

현대 데이터베이스 설계의 가장 중요한 원칙 중 하나는 **기본 키는 영원히 변하지 않아야 한다**는 것이다.
하지만 비즈니스 로직에 종속되는 자연 키는 이 원칙을 지키기 매우 어렵다.
